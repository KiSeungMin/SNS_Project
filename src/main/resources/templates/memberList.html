<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1.html}">

<th:block layout:fragment="script">

    <script th:inline="javascript">
        $(document).ready(function() {

            let followBtn = document.querySelector(".followBtn")

            followBtn.addEventListener("click", () => {

                if (followBtn.classList.contains("btn-primary")) {
                    followBtn.classList.remove("btn-primary");
                    followBtn.classList.add("btn-secondary");
                    followBtn.textContent = "unfollow";
                } else {
                    followBtn.classList.remove("btn-secondary");
                    followBtn.classList.add("btn-primary");
                    followBtn.textContent = "follow";
                }
            });
        });
    </script>
</th:block>

<div layout:fragment="content">
    <div id="container" class="container container-fluid border rounded">
        <div class="row row-cols-1 p-2" th:each="memberForm, status: ${memberList}">
            <div class="col d-flex align-items-center justify-content-start border-bottom rounded p-2 m-1 h-100">
                <a th:href="@{/member/{id}/memberPage (id=${memberForm.member.id})}">
                    <img th:src="|/images/memberForm.member.dataInfo.saveDataPath|" class = "rounded-circle" style="width: 2.5vw; height: 2.5vw;">
                </a>

                <h5 class = "ml-1" th:text="${memberForm.member.username}" style="font-size: 1.4vw;">username</h5>

                <iframe name="hiddenFrame" width="0" height="0" border="0" style="display: none;"></iframe>

                <form th:action="@{/member/{id}/follow (id=${memberForm.member.id})}" method="post" target= "hiddenFrame" style="position: absolute; right:1.5rem;">
                    <span th:if="${memberForm.followIsPresent}">
                        <button class="btn btn-secondary followBtn" type="submit" >unfollow</button>
                    </span>
                    <span th:unless="${memberForm.followIsPresent}">
                        <button class="btn btn-primary followBtn" type="submit">follow</button>
                    </span>
                </form>
            </div>
        </div>
    </div>
</div>